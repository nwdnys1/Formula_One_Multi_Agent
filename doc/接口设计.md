## 具体流程

具体流程见 Unity 相关：场景设计中的流程

## 需要关注的细节

prompt 的长度控制

体现多 agent 的合作

多 agent 的发言顺序

python 端流式输出（或显示思考中...+显示流式动画）

## Unity To LLM

下面如果 sender 是 unity、那么就代表是系统和用户指令、而不是 llm 生成的内容

### 媒体采访

1. 开始媒体采访

```json
{
  "sender": "unity",
  "receiver": ["journalist", "Verstappen", "Hamilton", "Wolff", "Horner"], // 参与者列表
  "signal": "media_interview_start" // 触发媒体采访的信号，重设会话（或触发对该场景的对应微调）并要求生成journalist的第一条内容
}
```

2. 采访流程

```json
{
  "sender": "journalist",
  "receiver": "Verstappen",
  "content": "请问维斯塔潘，您对本场比赛的期待是什么？"
}
```

```json
{
  "sender": "Verstappen",
  "receiver": "journalist",
  "content": "我希望能保持稳定的发挥，争取登上领奖台。"
}
```

如果这里的 receiver 是 Wolff，那么就让 content 采用输入框的输入（先前的都是来自于 python 的返回），否则，点击鼠标左键后，unity 向 python 端请求内容，等待内容生成后返回、再显示到界面上

```json
{
  "sender": "journalist",
  "receiver": "Wolff",
  "content": "请问 Wolff，您对本场比赛的期待是什么？"
}
```

```json
{
  "sender": "Wolff",
  "receiver": "journalist",
  "content": "我们会全力以赴，争取在比赛中取得好成绩。"
}
```

3. 结束媒体采访，要求生成新闻稿件

```json
{
  "sender": "unity",
  "receiver": "journalist",
  "signal": "media_interview_end" // 结束媒体采访的信号，生成新闻稿件
}
```

### 练习赛

1. 开始练习赛

```json
{
  "sender": "unity",
  "receiver": ["engineer", "Hamilton"], // 参与者列表
  "signal": "practice_session_start" // 触发练习赛的信号，重设会话（或触发对该场景的对应微调），并要求生成engineer的第一条内容，请根据赛道情况条件，进行调校。给出3种适合阿布扎比赛道的调校方案。
}
```

2. 选择完调校方案后，更新调校结果（这里的结果是 unity 端计算得到的）

```json
{
  "sender": "unity",
  "receiver": "Hamilton",
  "tuning_results": {
    "Oversteer": "Medium",
    "Braking Stability": "High",
    "Cornering": "High",
    "Traction": "Medium",
    "Straights": "Low"
  }
}
```

### 赛前车队会议

1. 开始赛前车队会议

```json
{
  "sender": "unity",
  "receiver": ["engineer", "Hamilton", "Wolff", "strategist"], // 参与者列表
  "signal": "before_meeting_start" // 触发赛前车队会议的信号，重设会话（或触发对该场景的对应微调）
}
```

2. 结束赛前车队会议

```json
{
  "sender": "unity",
  "receiver": ["engineer", "Hamilton", "Wolff", "strategist"], // 参与者列表
  "signal": "before_meeting_end" // 结束赛前车队会议的信号，要求生成会议总结
}
```

### 赛中策略

1. 开始比赛

```json
{
  "sender": "unity",
  "receiver": ["Hamilton", "Wolff", "strategist"], // 参与者列表
  "signal": "race_start" // 触发赛中策略的信号，重设会话（或触发对该场景的对应微调）
}
```

2. 环境信息更新

```json
{
  "sender": "unity",
  "receiver": "environment",
  "track_conditions": {
    "temperature": 30, // 温度
    "humidity": 50, // 湿度
    "wind_speed": 10 // 风速
  }
}
```

### 赛后车队会议

1. 开始赛前车队会议

```json
{
  "sender": "unity",
  "receiver": ["engineer", "Hamilton", "Wolff", "strategist"], // 参与者列表
  "signal": "after_meeting_start" // 触发赛后车队会议的信号，重设会话（或触发对该场景的对应微调）
}
```

2. 结束赛后车队会议

```json
{
  "sender": "unity",
  "receiver": ["engineer", "Hamilton", "Wolff", "strategist"], // 参与者列表
  "signal": "after_meeting_end" // 结束赛后车队会议的信号，生成会议总结
}
```

## LLM To Unity

### 媒体采访

0. 根据收到的信号、进行初始化和内容的生成

这里的媒体采访顺序主要通过这里开始的 content 进行设置，可以自定义也可以随机

1. 采访流程

```json
{
  "sender": "journalist",
  "receiver": "Verstappen",
  "content": "请问维斯塔潘，您对本场比赛的期待是什么？"
}
```

```json
{
  "sender": "Verstappen",
  "receiver": "journalist",
  "content": "我希望能保持稳定的发挥，争取登上领奖台。"
}
```

```json
{
  "sender": "journalist",
  "receiver": "Wolff",
  "content": "请问 Wolff，您对本场比赛的期待是什么？"
}
```

```json
{
  "sender": "Wolff",
  "receiver": "journalist",
  "content": "我们会全力以赴，争取在比赛中取得好成绩。"
}
```

LLM 内部结构可以是（就是调用的时候使用），发送给 unity 的时候不需要使用

```json
{
  "session_id": "media_interview_001", // 会话唯一标识
  "participants": ["journalist", "维斯塔潘", "汉密尔顿"], // 参与者列表
  "messages": [
    // 对话消息记录
    {
      "sender": "unity",
      "receiver": "journalist",
      "content": "现在是赛前的媒体采访时间，请向维斯塔潘进行简要的提问。"
    },
    {
      "sender": "journalist",
      "receiver": "维斯塔潘",
      "content": "维斯塔潘，你对今天的比赛有什么期待？"
    }
  ]
}
```

3. 结束媒体采访，返回新闻稿件

```json
{
  "sender": "journalist",
  "receiver": "unity",
  "news_article": {
    "title": "阿布扎比大奖赛前瞻：维斯塔潘与汉密尔顿的巅峰对决",
    "content": "在即将到来的阿布扎比大奖赛中，维斯塔潘和汉密尔顿将展开激烈的争夺。两位车手在本赛季的表现都非常出色，积分相同，谁能在这场比赛中胜出，将决定本赛季的世界冠军归属。"
  }
}
```

### 练习赛

1. 工程师的调校结果返回

```json
{
  "sender": "engineer",
  "content": "根据赛道情况，给出的3种适合阿布扎比赛道的调校方案。",
  "tuning_data": [
    {
      "Front Wing Angle": 6,
      "Rear Wing Angle": 12,
      "Anti-Roll Distribution": 4,
      "Tyre Camber": -3.0,
      "Toe-Out": 0.5
    },
    {
      "Front Wing Angle": 5,
      "Rear Wing Angle": 10,
      "Anti-Roll Distribution": 3,
      "Tyre Camber": -2.5,
      "Toe-Out": 0.7
    },
    {
      "Front Wing Angle": 7,
      "Rear Wing Angle": 14,
      "Anti-Roll Distribution": 5,
      "Tyre Camber": -3.5,
      "Toe-Out": 0.4
    }
  ]
}
```

2. 跑完每次练习之后，收到调校结果的的车手给工程师的反馈

```json
{
  "sender": "Hamilton",
  "receiver": "engineer",
  "content": "我觉得刚刚驾驶完后，调校的前翼角度有点大，在高速弯道中会有些不稳定。"
}
```

### 赛前车队会议

1. 会议总结

```json
{
  "sender": "Wolff",
  "receiver": "unity",
  "meeting_summary": {
    "title": "赛前车队会议总结",
    "content": "在赛前车队会议中，我们讨论了阿布扎比大奖赛的策略和调校方案。汉密尔顿表示对赛车的调校结果感到满意，并希望在比赛中保持稳定的发挥。我们还讨论了与红牛车队的竞争策略，确保在比赛中能够最大化我们的优势。"
  }
}
```

### 赛中策略

### 赛后车队会议

1. 会议总结

```json
{
  "sender": "Wolff",
  "receiver": "unity",
  "meeting_summary": {
    "title": "赛后车队会议总结",
    "content": "在赛后车队会议中，我们总结了阿布扎比大奖赛的表现。汉密尔顿在比赛中展现出了出色的驾驶技术，最终获得了亚军。我们讨论了比赛中的策略调整和赛车性能，并计划在未来的比赛中继续优化我们的策略和调校方案。"
  }
}
```
