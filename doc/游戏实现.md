## 游戏参数

主要分为车手参数、赛车性能参数、赛车调校参数，轮胎参数

### 车手参数

1. 车手总评 Overall rate

2. 车手心态 Attitude（分为积极、平衡、保守三种）

   - 积极：车手在比赛中表现积极，有更高的事故概率
   - 平衡：车手在比赛中表现平衡，事故概率正常
   - 保守：车手在比赛中表现保守，有更低的事故概率

3. 车手事故概率 Accidents rate

### 赛车性能参数

1. 赛车性能分为两大类：

   - 车辆速度 Velocity

     - Top Speed（基准：320km/h）
     - Acceleration（基准：15m/s^2）
     - DRS Effectiveness（基准：50%）

   - 车辆过弯 CarCornering （基准：3.5G）

### 赛车调校参数

1. 可调校内容及范围：

   - Front Wing Angle （范围：0-10°）
   - Rear Wing Angle（范围：8-18°）
   - Anti-Roll Distribution（抗侧倾分布）（范围：1:9-9:1）（比例调整）
   - Tyre Camber（轮胎外倾角）（范围：-3.50° - -2.00°）
   - Toe-Out（轮胎束角）（范围：0.00° - 1.00°）

2. 调校结果：（最终每个参数分档，每个档位对应一个后续影响速度的参数，共 1-5 5 档）（Disaster - Low - Medium - High - Perfect）(下面括号里的是影响因素)

   - Oversteer (Front Wing Angle , Tyre Camber)
   - Braking Stability （Anti-Roll Distribution，Tyre Camber）
   - Cornering（Front Wing Angle，Toe-Out）
   - Traction（Rear Wing Angle，Toe-Out）
   - Straights (Rear Wing Angle)

3. 阿布扎比最佳调校

   - Front Wing Angle ：5.0°
   - Rear Wing Angle ：12.5°
   - Anti-Roll Distribution ：3:7
   - Tyre Camber：-3.20°
   - Toe-Out：0.70°

4. 调校逻辑：

   - 根据偏移量进行分档、然后结合上面的相关内容进行调校结果的设置，比如 Oversteer 是和 Front Wing Angle，Tyre Camber 有关的，如果 Front Wing Angle 是 5°，Tyre Camber 是 -3.20°，那么 Oversteer 就是 Perfect；如果 Front Wing Angle 是 10°，Tyre Camber 是 -2.00°，那么 Oversteer 就是 Disaster。然后分档，最终结果是根据分档来决定的。然后如果调校内容和最佳调校差得近一点的话、那么调校结果就会更好，比如 medium

### 轮胎参数

1. 轮胎使用率 Tyre Wear Rate （0-100%）

   - 新轮胎的使用率为 100%，随着赛车行驶，这个数值会降低
   - 使用率是一个随时间线性减少的值，使用率达到 0% 时，轮胎爆胎，发生事故
   - 随着使用率提升、赛车的速度会逐渐降低

2. 轮胎种类

   - 轮胎种类分为 3 种：Hard、Medium、Soft
   - 越软的轮胎，速度越快，但是耐久性越差（即使用率下降越快）

3. 轮胎寿命

   - Hard：40 Laps
   - Medium：32 Laps
   - Soft：25 Laps

### 赛中参数

1. ERS 是否启动

   - 为了简化，此处实现为：每场比赛有一次使用 ERS 加速的机会、可以在 2 分钟内增加赛车的直道速度 15km/h 和加速度 2m/s^2

2. 油量释放

   - 为了简化，此处实现为：每场比赛有一次使用油量释放的机会、可以在 2 分钟内增加赛车的直道速度 7.5km/h 和加速度 1m/s^2

## 赛车速度逻辑

主要分为三种数值：加速度、弯道最大速度、直道最大速度。有以上不同的参数会影响这些速度的具体数值。

1. 有一个固定预设的基准加速度，以及弯道与直道上的基准速度限制，根据不同的队伍和实际性能情况、通过乘以不同的参数来调整为最终的数值

2. 加速度 15m/s^2

   - 轮胎参数：

     - Tyre Wear Rate

   - 调校结果：（Disaster - Low - Medium - High - Perfect 对应 1-5）

     - Straights
     - Traction

   - 车手参数：

     - Overall rate
     - Attitude

   - 赛中因素：

     - 油量释放
     - ERS 释放

   - 赛车性能因素：

     - Acceleration

   - 公式：

     - 加速度 =

3. 弯道最大速度（不同弯可以有不同的限制，以 50km/h 为基准）

   - 轮胎参数：

     - Tyre Wear Rate

   - 调校结果：

     - Oversteer
     - Braking Stability
     - Cornering
     - Traction

   - 车手参数：

     - Overall rate
     - Attitude

   - 赛车性能因素：

     - CarCornering

   - 公式：

     - 弯道最大速度 =

4. 直道最大速度

   - 赛车性能因素：

     - Top Speed

   - 赛中因素：

     - 油量释放
     - ERS 释放

   - 公式：

     - 直道最大速度 = Top Speed + ERS 释放效果 + 油量释放效果 + DRS 效果

5. 减速加速度：所有赛车固定为 50m/s^2

## 具体的比赛中的事件实现逻辑

### 运行逻辑

https://liquipedia.net/formula1/Yas_Marina_Circuit

0. 赛道信息：5.281km，共 16 个弯道，最高时速 350km/h，圈速记录 1:26.103。

1. 赛车可视作在轨道上进行的线性变速运动，可以通过设置加速度和最大速度来模拟赛车的运动。

2. 赛道分为弯道和直道，弯道时车速较慢（可以根据弯道的不同设置不同的弯道基础最大速度，从 30km/h 到 100km/h），直道时车速较快（但是也是线性加速）。

3. 弯道减速逻辑，进入刹车区（即弯道开始时，赛车速度以 50m/s^2 内线性减速到赛车弯道最大速度），然后在弯道中保持最大速度，然后在弯道结束时根据赛车的加速度加速，最高至赛车的直道最大速度。

### 超车逻辑

1. 在弯道开始时，设置一个检查点，检查与前车的距离是否在一定范围内，要求车距在 0.2 车身长度之内，即触发超车动画

2. 超车动画为：

   - 超车车辆加速，前车减速
   - 超车车辆变换车道，前车保持车道
   - 超过前车后，超车车辆路径恢复原来的路径
   - 使得驶出弯道后，超车车辆在前车前方至少 0.3 车身长度

### 赛车事故逻辑

0. 基于 Accidents rate 发生，每 600s （游戏内时间） 对车手进行一次随机数的监测、如果随机数小于 Accidents rate，则发生事故

1. 赛车事故：在赛车过弯时，有固定的概率发生事故（不同车手概率不同）

2. 事故逻辑：赛车原地旋转 180 度，然后撞墙，触发安全车，然后赛车模型从赛道上消失

### 安全车逻辑

1. 安全车出动时，所有车辆先正常行驶，安全车从维修区出口开始行驶，安全车行驶到赛道上后，所有在这个时候处于安全车后方的赛车都不允许超过安全车

2. 在安全车后跟车时，车辆减速到 80km/h，保持车距 1 个车身，直到安全车离开赛道（默认带 3 圈，除去解套）

### 换胎逻辑

1. 从维修区入口进入，走一条不同的路径，从维修区出口出，省略去换胎动画

2. 每个车队的换胎时间不同（在 1.8-3.5s 之间），可以设置一个换胎时间的随机数，模拟换胎时间的不确定性

3. 换胎可能会有失误，失误率 5%（不同车队不同），失误时在维修区停留 10s，然后重新出发

## 赛道测时逻辑

1. 赛道测时：

   - 赛道分为 3 个 sector（扇区），在每个 sector 的末端、赛道上有一个测时点，用于记录赛车行驶的时间
   - 每个 sector 里还有 6 mini sectors，用于记录赛车在 sector 里实时的时间

2. 左侧的 Interval 显示 3 种内容（可切换）：

   - 显示当前赛车与前车的时间差，单位为秒
   - 显示赛车当前的轮胎和剩余轮胎量

3. 实现方式：每辆赛车记录一个从开始时间到当前时间的时间戳，每次更新时计算时间差，然后更新显示内容

### DRS 逻辑

0. DRS：Drag Reduction System，减阻系统，是一种在 F1 赛车中使用的技术，可以在直道上增加赛车速度。

1. DRS 可以在直道上使用，可以额外线性地增加赛车速度（最高增加 15km/h）

2. 赛道共 2 个 DRS 区域，在行驶到赛道上固定的 DRS 监测点时，如果距离前车小于等于 1s，且在 DRS 区域内，可以使用 DRS 增加尾速

## 实际细节动画（可后续实现，不是重点）

1. 在通过弯角时，两个前轮需要进行对应角度的转动动画

2. 在行驶时，四个轮子需要进行以车轴为中心进行基于速度大小的旋转
